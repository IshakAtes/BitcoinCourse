<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quandl</title>
    <script>
        const API_KEY = 'Wq21koWsEou7oMwoxLyx';

        // =============================CALCULATE DATE FIRST METHOD ======================================

        // function dateConfiguration(){
        //     var today = new Date();
        //     var day =  String(today.getDate()) -1
        //     var dd = (String(day).padStart(2, '0'));
        //     var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
        //     var yyyy = today.getFullYear();

        //     today = yyyy + '-' + mm + '-' + dd;
        //     console.log(today)
        //     loadCourse(today);

            /// ADD THIS TWO VARIABLE TO FUNCTION loadCourse(today) / to make it functionally and body onload="dateConfiguration()"
            ///            let startDate = today;
            ///            let endDate = today;

        // }

        // =============================CALCULATE DATE SECOND METHOD ======================================
        
        async function loadCourse(){
            let today = new Date();
            today.setDate(new Date().getDate() - 1);
            console.log(today)
            // SHOW ONLY DATE WITHOUT TIMESTAMP
            // var tod = today;
            // var year = tod.getFullYear();
            // var mes = tod.getMonth()+1;
            // var dia = tod.getDate();
            // var fecha =year+"-"+mes+"-"+dia;
            // console.log(fecha);
            let startDate = today;
            let endDate = today;   
            let url = `https://data.nasdaq.com/api/v3/datasets/BCHAIN/MKPRU?start_date=${startDate}&end_date=${endDate}&api_key=Wq21koWsEou7oMwoxLyx`;
            let response = await fetch(url);
            let responseAsJson = await response.json();
            console.log('API answers:', responseAsJson['dataset'])
            showBitcoinToday(responseAsJson);
        }

        function showBitcoinToday(responseAsJson){
            let bitcoinToday = responseAsJson['dataset']['data'][0][1];
            document.getElementById('bitcoinToday').innerHTML = bitcoinToday;
        }
    </script>
</head>
<body onload="loadCourse()">

    <h1>Was kostet ein Bitcoin aktuell?</h1>

    <div>Aktuell kostet ein Bitcoin <b id="bitcoinToday">60.000</b> USD</div>
    
</body>
</html>